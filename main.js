!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",modalInputErrorClass:"modal__input_type_error",inactiveButtonClass:"modal__submit-button_disabled"},t=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.modalInputErrorClass),o.textContent=""},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)};function n(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}const a=document.querySelectorAll(".modal"),s=document.querySelectorAll(".modal__close-button"),l=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__new-button"),c=document.querySelector(".profile__name"),d=document.querySelector(".profile__description"),u=document.querySelector(".profile__avatar"),m=document.querySelector(".profile__avatar-button"),_=document.querySelector("#edit-avatar"),h=document.forms["edit-avatar"],f=_.querySelector("#avatar-link-input"),y=_.querySelector(".modal__submit-button"),v=document.querySelector("#popup-modal"),p=v.querySelector(".modal__image"),b=v.querySelector(".modal__caption"),S=document.querySelector("#add-modal"),E=document.forms["new-post"],g=S.querySelector("#add-image-link-input"),q=S.querySelector("#add-caption-input"),k=S.querySelector(".modal__submit-button"),L=document.querySelector("#edit-modal"),C=L.querySelector("#profile-name-input"),$=L.querySelector("#profile-description-input"),j=document.forms["edit-profile"],U=L.querySelector(".modal__submit-button"),A=document.querySelector("#card-template"),P=document.querySelector(".cards__list"),x=document.querySelector("#delete-modal"),I=x.querySelector(".modal__submit-button"),w=document.forms["delete-card"],T=x.querySelector(".modal__submit-button_type_cancel");let D,N;const B=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewcard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}toggleLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"688c9307-1ad5-4d00-8cf7-8ff6067c0470","Content-Type":"application/json"}});function O(e){e.classList.add("modal_opened"),document.addEventListener("keydown",H)}function J(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",H)}function H(e){"Escape"===e.key&&J(document.querySelector(".modal_opened"))}function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=function(e){const t=A.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return e.isLiked&&n.classList.toggle("card__like-button_liked"),r.textContent=e.name,o.src=e.link,o.alt=e.name+" image",o.addEventListener("click",(()=>{p.src=e.link,p.alt=e.name+" image",b.textContent=e.name,p.onload=function(){p.classList.remove("modal__image_type_landscape","modal__image_type_portrait"),this.width>this.height?p.classList.add("modal__image_type_landscape"):p.classList.add("modal__image_type_portrait")},O(v)})),n.addEventListener("click",(t=>{!function(e,t){const r=e.isLiked;B.toggleLike(t,r).then((()=>{e.target.classList.toggle("card__like-button_liked")})).catch((e=>{console.error(e)}))}(t,e._id)})),a.addEventListener("click",(r=>function(e,t){D=e,N=t._id,O(x)}(t,e))),t}(e);P[t](r)}var M;B.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{z(e)})),u.src=r.avatar,c.textContent=r.name,d.textContent=r.about})).catch((e=>{console.error(e)})),m.addEventListener("click",(()=>{O(_)})),h.addEventListener("submit",(t=>function(t){n(y,!0),B.editAvatar(f.value).then((r=>{u.src=r.avatar,t.target.reset(),o(y,e),J(_)})).catch((e=>{console.error(e)})).finally((()=>{n(y,!1)}))}(t))),w.addEventListener("submit",(function(){n(I,!0,"Delete","Deleting..."),B.deleteCard(N).then((()=>{D.remove(),J(x)})).catch((e=>{console.error(e)})).finally((()=>{n(I,!1,"Delete")}))})),T.addEventListener("click",(()=>{J(x)})),l.addEventListener("click",(()=>{(function(){var r,o;C.value=c.textContent,$.value=d.textContent,r=L,o=e,[C,$].forEach((e=>{t(r,e,o)}))})(),O(L)})),s.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>{J(t)}))})),a.forEach((e=>{e.addEventListener("click",(t=>{t.target.closest(".modal__container")||J(e)}))})),j.addEventListener("submit",(function(){n(U,!0),B.editUserInfo({name:C.value,about:$.value}).then((t=>{c.textContent=t.name,d.textContent=t.about,o(U,e),J(L)})).catch((e=>console.error(e))).finally((()=>{n(U,!1)}))})),E.addEventListener("submit",(function(t){const r={name:q.value,link:g.value};n(k,!0),B.addNewcard(r).then((r=>{z(r),t.target.reset(),o(k,e),J(S)})).catch((e=>console.log(e))).finally((()=>{n(k,!1)}))})),i.addEventListener("click",(()=>{O(S)})),M=e,Array.from(document.querySelectorAll(M.formSelector)).forEach((e=>{e.addEventListener("submit",(e=>{e.preventDefault()})),((e,o)=>{const n=Array.from(e.querySelectorAll(o.inputSelector)),a=e.querySelector(o.submitButtonSelector);r(n,a,o),n.forEach((s=>{s.addEventListener("input",(()=>{((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.add(o.modalInputErrorClass),n.textContent=r})(e,r,r.validationMessage,o)})(e,s,o),r(n,a,o)}))}))})(e,M)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUIsU0FBUyxLQUN6Q0YsRUFBVXZELEVBQVMsSUZ0UEszQyxFRW9RVFQsRUZuUUUySixNQUFNQyxLQUFLekgsU0FBU0MsaUJBQWlCM0IsRUFBT1IsZUFFcEQ2SSxTQUFTdkksSUFDaEJBLEVBQVlzRyxpQkFBaUIsVUFBV0ksSUFDdENBLEVBQUk0QyxnQkFBZ0IsSUFyQkFDLEVBQUN2SixFQUFhRSxLQUN0QyxNQUFNUSxFQUFZMEksTUFBTUMsS0FDdEJySixFQUFZNkIsaUJBQWlCM0IsRUFBT1AsZ0JBRWhDZ0IsRUFBZ0JYLEVBQVlJLGNBQWNGLEVBQU9OLHNCQUV2RGEsRUFBa0JDLEVBQVdDLEVBQWVULEdBRTVDUSxFQUFVNkgsU0FBU3RJLElBQ2pCQSxFQUFhcUcsaUJBQWlCLFNBQVMsS0FoRGhCa0QsRUFBQ3hKLEVBQWFDLEVBQWNDLEtBQ2hERCxFQUFhWSxTQUFTQyxNQVF6QmYsRUFBZUMsRUFBYUMsRUFBY0MsR0FyQnZCdUosRUFBQ3pKLEVBQWFDLEVBQWN5SixFQUFjeEosS0FDL0QsTUFBTUMsRUFBZUgsRUFBWUksY0FBYyxJQUFJSCxFQUFhSSxZQUNoRUosRUFBYUssVUFBVVksSUFBSWhCLEVBQU9MLHNCQUNsQ00sRUFBYUssWUFBY2tKLENBQVksRUFXckNELENBQ0V6SixFQUNBQyxFQUNBQSxFQUFhMEosa0JBQ2J6SixFQUlKLEVBdUNJc0osQ0FBbUJ4SixFQUFhQyxFQUFjQyxHQUM5Q08sRUFBa0JDLEVBQVdDLEVBQWVULEVBQU8sR0FDbkQsR0FDRixFQVVBcUosQ0FBa0J2SixFQUFhRSxFQUFPLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXG4gIG1vZGFsSW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcbn07XG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLm1vZGFsSW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLm1vZGFsSW5wdXRFcnJvckNsYXNzKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICB9XG59O1xuXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5jb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG5cbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcbiAgICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCB7IHNldHRpbmdzLCBkaXNhYmxlQnV0dG9uLCBlbmFibGVWYWxpZGF0aW9uLCByZXNldFZhbGlkYXRpb24gfTtcbi8vZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcbiAgYnRuLFxuICBpc0xvYWRpbmcsXG4gIGRlZmF1bHRUZXh0ID0gXCJTYXZlXCIsXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICBidG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgfSBlbHNlIHtcbiAgICBidG4udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgc2V0dGluZ3MsXG4gIGRpc2FibGVCdXR0b24sXG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHJlc2V0VmFsaWRhdGlvbixcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcblxuLypcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiR29sZGVuIGdhdGUgYnJpZGdlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzctcGhvdG8tYnktZ3JpZmZpbi13b29sZHJpZGdlLWZyb20tcGV4ZWxzLmpwZ1wiLFxuICB9LFxuXTtcbiovXG4vL2FsbCBtb2RhbHNcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG5cbi8vcHJvZmlsZSBzdHVmZlxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZU5ld0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmV3LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuLy9hdmF0YXIgc3R1ZmZcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcbmNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIik7XG5jb25zdCBlZGl0QXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYXZhdGFyXCIpO1xuY29uc3QgZWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImVkaXQtYXZhdGFyXCJdO1xuY29uc3QgZWRpdEF2YXRhcklucHV0ID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmstaW5wdXRcIik7XG5jb25zdCBlZGl0QXZhdGFyU3VibWl0QnV0dG9uID0gZWRpdEF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCJcbik7XG5cbi8vcHJldmlldyB3aW5kb3cgbW9kYWxcbmNvbnN0IHBvcHVwTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BvcHVwLW1vZGFsXCIpO1xuY29uc3QgcG9wdXBNb2RhbEltYWdlID0gcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHBvcHVwTW9kYWxDYXB0aW9uID0gcG9wdXBNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vL2FkZCBuZXcgY2FyZCBzdHVmZlxuY29uc3QgYWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1tb2RhbFwiKTtcbmNvbnN0IGFkZEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJuZXctcG9zdFwiXTtcbmNvbnN0IGFkZExpbmtJbnB1dCA9IGFkZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWltYWdlLWxpbmstaW5wdXRcIik7XG5jb25zdCBhZGRDYXB0aW9uSW5wdXQgPSBhZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXB0aW9uLWlucHV0XCIpO1xuY29uc3QgYWRkTW9kYWxTdWJtaXRCdXR0b24gPSBhZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuXG4vL2VkaXQgcHJvZmlsZSBzdHVmZlxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuY29uc3QgbW9kYWxOYW1lSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XG5jb25zdCBtb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJlZGl0LXByb2ZpbGVcIl07XG5jb25zdCBlZGl0TW9kYWxTdWJtaXRCdXR0b24gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcblxuLy9jYXJkIHN0dWZmXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG4vL2RlbGV0ZSBjYXJkIHN0dWZmXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlTW9kYWxTdWJtaXRCdXR0b24gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXG4pO1xuY29uc3QgZGVsZXRlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiZGVsZXRlLWNhcmRcIl07XG5jb25zdCBkZWxldGVNb2RhbENhbmNlbEJ1dHRvbiA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uX3R5cGVfY2FuY2VsXCJcbik7XG5cbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI2ODhjOTMwNy0xYWQ1LTRkMDAtOGNmNy04ZmY2MDY3YzA0NzBcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5hcGlcbiAgLmdldEFwcEluZm8oKVxuICAudGhlbigoW2NhcmRzLCB1c2VyXSkgPT4ge1xuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZCk7XG4gICAgfSk7XG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2VyLmF2YXRhcjtcbiAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXIubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSk7XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gIGNvbnN0IGNhcmROYW1lRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRMaW5rRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcblxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICB9XG5cbiAgY2FyZE5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkTGlua0VsZW1lbnQuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkTGlua0VsZW1lbnQuYWx0ID0gZGF0YS5uYW1lICsgXCIgaW1hZ2VcIjtcblxuICBjYXJkTGlua0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBwb3B1cE1vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHBvcHVwTW9kYWxJbWFnZS5hbHQgPSBkYXRhLm5hbWUgKyBcIiBpbWFnZVwiO1xuICAgIHBvcHVwTW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuXG4gICAgcG9wdXBNb2RhbEltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHBvcHVwTW9kYWxJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKFxuICAgICAgICBcIm1vZGFsX19pbWFnZV90eXBlX2xhbmRzY2FwZVwiLFxuICAgICAgICBcIm1vZGFsX19pbWFnZV90eXBlX3BvcnRyYWl0XCJcbiAgICAgICk7XG5cbiAgICAgIGlmICh0aGlzLndpZHRoID4gdGhpcy5oZWlnaHQpIHtcbiAgICAgICAgcG9wdXBNb2RhbEltYWdlLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9faW1hZ2VfdHlwZV9sYW5kc2NhcGVcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwb3B1cE1vZGFsSW1hZ2UuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19pbWFnZV90eXBlX3BvcnRyYWl0XCIpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBvcGVuTW9kYWwocG9wdXBNb2RhbCk7XG4gIH0pO1xuXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgaGFuZGxlTGlrZUJ1dHRvbihldnQsIGRhdGEuX2lkKTtcbiAgfSk7XG5cbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKVxuICApO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcbn0pO1xuXG5lZGl0QXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGhhbmRsZUF2YXRhclN1Ym1pdChldnQpKTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xuICBzZXRCdXR0b25UZXh0KGVkaXRBdmF0YXJTdWJtaXRCdXR0b24sIHRydWUpO1xuICBhcGlcbiAgICAuZWRpdEF2YXRhcihlZGl0QXZhdGFySW5wdXQudmFsdWUpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGVkaXRBdmF0YXJTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcbiAgICAgIGNsb3NlTW9kYWwoZWRpdEF2YXRhck1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KGVkaXRBdmF0YXJTdWJtaXRCdXR0b24sIGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUJ1dHRvbihldnQsIGlkKSB7XG4gIGNvbnN0IGlzTGlrZWQgPSBldnQuaXNMaWtlZDtcblxuICBhcGlcbiAgICAudG9nZ2xlTGlrZShpZCwgaXNMaWtlZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdCgpIHtcbiAgc2V0QnV0dG9uVGV4dChkZWxldGVNb2RhbFN1Ym1pdEJ1dHRvbiwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChkZWxldGVNb2RhbFN1Ym1pdEJ1dHRvbiwgZmFsc2UsIFwiRGVsZXRlXCIpO1xuICAgIH0pO1xufVxuXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxuZGVsZXRlTW9kYWxDYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG59KTtcblxuZnVuY3Rpb24gaGFuZGxlRWRpdFByb2ZpbGVGb3JtU3VibWl0KCkge1xuICBzZXRCdXR0b25UZXh0KGVkaXRNb2RhbFN1Ym1pdEJ1dHRvbiwgdHJ1ZSk7XG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oe1xuICAgICAgbmFtZTogbW9kYWxOYW1lSW5wdXQudmFsdWUsXG4gICAgICBhYm91dDogbW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICAgIGRpc2FibGVCdXR0b24oZWRpdE1vZGFsU3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoZWRpdE1vZGFsU3VibWl0QnV0dG9uLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZFByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xuICBjb25zdCBpbnB1dFZhbHVlcyA9IHsgbmFtZTogYWRkQ2FwdGlvbklucHV0LnZhbHVlLCBsaW5rOiBhZGRMaW5rSW5wdXQudmFsdWUgfTtcbiAgc2V0QnV0dG9uVGV4dChhZGRNb2RhbFN1Ym1pdEJ1dHRvbiwgdHJ1ZSk7XG4gIGFwaVxuICAgIC5hZGROZXdjYXJkKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKGRhdGEpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgZGlzYWJsZUJ1dHRvbihhZGRNb2RhbFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgICAgY2xvc2VNb2RhbChhZGRNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KGFkZE1vZGFsU3VibWl0QnV0dG9uLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcbiAgbW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgbW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oZWRpdE1vZGFsLCBbbW9kYWxOYW1lSW5wdXQsIG1vZGFsRGVzY3JpcHRpb25JbnB1dF0sIHNldHRpbmdzKTtcbn1cblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGVzY2FwZU1vZGFsKTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlc2NhcGVNb2RhbCk7XG59XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGZpbGxQcm9maWxlRm9ybSgpO1xuICBvcGVuTW9kYWwoZWRpdE1vZGFsKTtcbn0pO1xuXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XG4gIGNvbnN0IHBvcHVwID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGNsb3NlTW9kYWwocG9wdXApO1xuICB9KTtcbn0pO1xuXG5mdW5jdGlvbiBlc2NhcGVNb2RhbChldnQpIHtcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICBjb25zdCBhY3RpdmVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGNsb3NlTW9kYWwoYWN0aXZlTW9kYWwpO1xuICB9XG59XG5cbm1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgIGlmICghZXZ0LnRhcmdldC5jbG9zZXN0KFwiLm1vZGFsX19jb250YWluZXJcIikpIHtcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdFByb2ZpbGVGb3JtU3VibWl0KTtcblxuYWRkRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRQcm9maWxlRm9ybVN1Ym1pdCk7XG5cbnByb2ZpbGVOZXdCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGFkZE1vZGFsKTtcbn0pO1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmQsIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XG4gIGNhcmRzTGlzdFttZXRob2RdKGNhcmRFbGVtZW50KTtcbn1cblxuLypcbmluaXRpYWxDYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gIHJlbmRlckNhcmQoY2FyZCk7XG59KTtcbiovXG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBlZGl0QXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZE5ld2NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRvZ2dsZUxpa2UoaWQsIGlzTGlrZWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJtb2RhbElucHV0RXJyb3JDbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInNldEJ1dHRvblRleHQiLCJidG4iLCJpc0xvYWRpbmciLCJkZWZhdWx0VGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImxvYWRpbmdUZXh0IiwibW9kYWxzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY2xvc2VCdXR0b25zIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlTmV3QnV0dG9uIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiZWRpdEF2YXRhckJ1dHRvbiIsImVkaXRBdmF0YXJNb2RhbCIsImVkaXRBdmF0YXJGb3JtIiwiZm9ybXMiLCJlZGl0QXZhdGFySW5wdXQiLCJlZGl0QXZhdGFyU3VibWl0QnV0dG9uIiwicG9wdXBNb2RhbCIsInBvcHVwTW9kYWxJbWFnZSIsInBvcHVwTW9kYWxDYXB0aW9uIiwiYWRkTW9kYWwiLCJhZGRGb3JtRWxlbWVudCIsImFkZExpbmtJbnB1dCIsImFkZENhcHRpb25JbnB1dCIsImFkZE1vZGFsU3VibWl0QnV0dG9uIiwiZWRpdE1vZGFsIiwibW9kYWxOYW1lSW5wdXQiLCJtb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxTdWJtaXRCdXR0b24iLCJjYXJkVGVtcGxhdGUiLCJjYXJkc0xpc3QiLCJkZWxldGVNb2RhbCIsImRlbGV0ZU1vZGFsU3VibWl0QnV0dG9uIiwiZGVsZXRlRm9ybSIsImRlbGV0ZU1vZGFsQ2FuY2VsQnV0dG9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFyIiwiYXZhdGFyIiwiYWRkTmV3Y2FyZCIsIl9yZWYzIiwibGluayIsImRlbGV0ZUNhcmQiLCJ0b2dnbGVMaWtlIiwiaXNMaWtlZCIsImF1dGhvcml6YXRpb24iLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlc2NhcGVNb2RhbCIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5IiwicmVuZGVyQ2FyZCIsImNhcmQiLCJjYXJkRWxlbWVudCIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbGVtZW50IiwiY2FyZExpbmtFbGVtZW50IiwiY2FyZExpa2VCdXR0b24iLCJjYXJkRGVsZXRlQnV0dG9uIiwidG9nZ2xlIiwic3JjIiwiYWx0Iiwib25sb2FkIiwid2lkdGgiLCJoZWlnaHQiLCJ0YXJnZXQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImhhbmRsZUxpa2VCdXR0b24iLCJfaWQiLCJoYW5kbGVEZWxldGVDYXJkIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkcyIsInVzZXIiLCJmb3JFYWNoIiwidmFsdWUiLCJyZXNldCIsImZpbmFsbHkiLCJoYW5kbGVBdmF0YXJTdWJtaXQiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsImZpbGxQcm9maWxlRm9ybSIsImJ1dHRvbiIsInBvcHVwIiwiY2xvc2VzdCIsImlucHV0VmFsdWVzIiwibG9nIiwiQXJyYXkiLCJmcm9tIiwicHJldmVudERlZmF1bHQiLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9